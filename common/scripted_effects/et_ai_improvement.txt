et_ai_improvement_effect_dynamic = {
    if = {
        # Use reserve/income ratio for dynamic scaling
        if = {
            limit = { NOT = { has_modifier = et_budget_cooldown } }
            if = {
                limit = { et_reserve_income_ratio > 100 }
                set_government_wage_level = very_low
                set_military_wage_level = very_low
            }
            else_if = {
                limit = { et_reserve_income_ratio > 50 }
                set_government_wage_level = low
                set_military_wage_level = low
            }
            else_if = {
                limit = {
                    et_reserve_income_ratio > 10
                    gold_reserves > 0
                }
                set_government_wage_level = medium
                set_military_wage_level = medium
            }
            else_if = {
                limit = {
                    et_reserve_income_ratio > 5
                    gold_reserves > 0
                }
                set_government_wage_level = high
                set_military_wage_level = high
            }
            else = {
                limit = { gold_reserves > 0 }
                set_government_wage_level = very_high
                set_military_wage_level = very_high
            }
        }


        # Subsidize or unsubsidize ports based on principal
        if = {
            limit = { gold_reserves < 0 }
            every_scope_building = {
                limit = { is_building_type = building_port }
                set_subsidized = no
            }
        }
        if = {
            limit = { gold_reserves > 0 }
            every_scope_building = {
                limit = { is_building_type = building_port }
                set_subsidized = yes
            }
        }

        set_variable = { name = et_budget_cooldown days = 90 }

        # Bureaucracy modifier logic always runs
        if = {
            limit = {
                bureaucracy < -10
                NOT = { has_modifier = et_negative_bureaucracy }
            }
            add_modifier = { name = et_negative_bureaucracy days = 365 hidden = yes }
        }
    }
}

et_ai_building_subsidized = {
    every_scope_building = {
        limit = {
            OR = {
                is_building_type = building_port
                is_building_type = building_trade_center
                is_building_type = building_railway
                is_building_type = building_power_plant
            }
            weekly_profit > -500
        }
        set_subsidized = yes
    }
}

et_ai_building_not_subsidized = {
    every_scope_building = {
        limit = {
            OR = {
                is_building_type = building_port
                is_building_type = building_trade_center
                is_building_type = building_railway
                is_building_type = building_power_plant
            }
            weekly_profit < -500
        }
        set_subsidized = no
    }
}

et_ai_auto_build = {
    #this is for ai auto build dont mess with it
    random_scope_state = {
        limit = {
            any_scope_building = { is_building_type = building_government_administration occupancy > 0.25 }
        }
        start_privately_funded_building_construction = building_government_administration
    }
}