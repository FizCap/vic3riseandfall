rf_annex_decentralized_limited_effect = {
    every_decentralized_country = {
        limit = {
            num_states <= 3
            any_scope_state = {
                any_neighbouring_state = {
                    owner = {
                        is_country_type = decentralized
                        num_states <= 3
                    }
                }
            }
        }
        random_list = {
            20 = {
                save_scope_as = annexing_country
                random_decentralized_country = {
                    limit = {
                        any_scope_state = {
                            any_neighbouring_state = { owner = scope:annexing_country }
                        }
                    }
                    # Check annexing country's state count to determine target
                    if = {
                        limit = { scope:annexing_country.num_states = 1 }
                        if = {
                            limit = { num_states = 1 }
                            scope:annexing_country = { annex = PREV }
                        }
                    }
                    else_if = {
                        limit = { scope:annexing_country.num_states = 2 }
                        if = {
                            limit = { num_states <= 2 }
                            scope:annexing_country = { annex = PREV }
                        }
                    }
                    else = {
                        if = {
                            limit = { num_states <= 3 }
                            scope:annexing_country = { annex = PREV }
                        }
                    }
                }
            }
            80 = {
                # Do nothing - 80% chance nothing happens
            }
        }
    }
}

rf_annex_decentralized_unlimited_effect = {
    every_decentralized_country = {
        save_scope_as = annexing_country
        every_decentralized_country = {
            limit = {
                any_scope_state = {
                    any_neighbouring_state = { owner = scope:annexing_country }
                }
            }
            scope:annexing_country = { annex = PREV }
        }
    }
}

#Credit to CaesarVincens for the original script